"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1137],{1137:(F,m,s)=>{s.r(m),s.d(m,{ReservationDetailsPage:()=>M});var p=s(467),v=s(177),r=s(6087),_=s(5079),g=s(5873),u=s(3114),t=s(4438),f=s(6766);function x(i,c){1&i&&(t.j41(0,"div",7)(1,"div",8),t.nrm(2,"ion-icon",9),t.k0s(),t.j41(3,"div",10)(4,"p")(5,"strong"),t.EFF(6,"Cette chambre n'a pas encore \xe9t\xe9 pay\xe9e"),t.k0s()(),t.j41(7,"p"),t.EFF(8,"Il vous reste "),t.j41(9,"strong"),t.EFF(10,"7 jours"),t.k0s(),t.EFF(11," pour valider le paiement"),t.k0s()()())}function h(i,c){if(1&i){const o=t.RV6();t.j41(0,"div",31)(1,"div",32),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.selectReceiptImage())}),t.nrm(2,"ion-icon",33),t.j41(3,"span"),t.EFF(4,"Ajouter une image"),t.k0s()()()}}function P(i,c){if(1&i){const o=t.RV6();t.j41(0,"div",34),t.nrm(1,"img",35),t.j41(2,"div",36)(3,"p",37),t.EFF(4),t.k0s(),t.j41(5,"a",38),t.bIt("click",function(n){return t.eBV(o),t.Njj(n.preventDefault())}),t.EFF(6),t.k0s()()()}if(2&i){const o=t.XpG(2);t.R7$(),t.Y8G("src",o.reservation.receiptImage,t.B4B),t.R7$(3),t.JRh(o.reservation.receiptFileName),t.R7$(),t.AVh("verified",o.reservation.receiptVerified),t.R7$(),t.SpI(" ",o.reservation.receiptVerified?"V\xe9rifi\xe9":"En attente de v\xe9rification"," ")}}function C(i,c){if(1&i){const o=t.RV6();t.j41(0,"ion-button",39),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.validateReservation())}),t.EFF(1," Valider la r\xe9servation\n"),t.k0s()}if(2&i){const o=t.XpG(2);t.Y8G("disabled",!o.reservation.receiptImage||"reservee"!==o.reservation.status)}}function b(i,c){if(1&i){const o=t.RV6();t.j41(0,"div",40)(1,"h3"),t.EFF(2,"Contrat de bail"),t.k0s(),t.j41(3,"p",41),t.EFF(4,"T\xe9l\xe9charger et signer le contrat de bail"),t.k0s(),t.j41(5,"div",42)(6,"div",43),t.EFF(7,"\u{1f4c4}"),t.k0s(),t.j41(8,"div",44)(9,"p",45),t.EFF(10),t.k0s(),t.j41(11,"p",46),t.EFF(12,"Document PDF \xe0 signer"),t.k0s()(),t.j41(13,"ion-button",47),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.downloadContract())}),t.nrm(14,"ion-icon",48),t.EFF(15," T\xe9l\xe9charger "),t.k0s()(),t.j41(16,"div",49)(17,"p"),t.EFF(18," Il faudra le scanner et le renvoyer au propri\xe9taire pour signature des 2 partis. "),t.k0s()()()}if(2&i){const o=t.XpG(2);t.R7$(10),t.SpI("Contrat de bail - ",o.reservation.cityName,"")}}function E(i,c){if(1&i&&(t.j41(0,"div",11)(1,"div",12)(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"p",13),t.EFF(5),t.k0s()(),t.j41(6,"div",14)(7,"div",15)(8,"span",16),t.EFF(9,"Num\xe9ro de chambre"),t.k0s(),t.j41(10,"span",17),t.EFF(11),t.k0s()(),t.j41(12,"div",15)(13,"span",16),t.EFF(14,"\xc9tage"),t.k0s(),t.j41(15,"span",17),t.EFF(16),t.k0s()(),t.j41(17,"div",15)(18,"span",16),t.EFF(19,"Statut"),t.k0s(),t.j41(20,"ion-badge",18),t.EFF(21),t.k0s()()(),t.j41(22,"div",19)(23,"h3"),t.EFF(24,"Informations sur le paiement"),t.k0s(),t.j41(25,"div",20)(26,"div",21)(27,"span",22),t.EFF(28,"Montant"),t.k0s(),t.j41(29,"span",23),t.EFF(30),t.k0s()(),t.j41(31,"div",21)(32,"span",22),t.EFF(33,"Mode de paiement"),t.k0s(),t.j41(34,"span",24),t.EFF(35),t.k0s()(),t.j41(36,"div",21)(37,"span",22),t.EFF(38,"Date de r\xe9servation"),t.k0s(),t.j41(39,"span",24),t.EFF(40),t.k0s()(),t.j41(41,"div",21)(42,"span",22),t.EFF(43,"Titulaire"),t.k0s(),t.j41(44,"span",24),t.EFF(45),t.k0s()()()(),t.j41(46,"div",25)(47,"h3"),t.EFF(48,"Valider la r\xe9servation"),t.k0s(),t.j41(49,"p",26),t.EFF(50,"Valider la r\xe9servation avec une photo du re\xe7u"),t.k0s(),t.DNE(51,h,5,0,"div",27)(52,P,7,5,"div",28)(53,C,2,1,"ion-button",29),t.k0s(),t.DNE(54,b,19,1,"div",30),t.k0s()),2&i){const o=t.XpG();t.R7$(3),t.JRh(o.reservation.cityName),t.R7$(2),t.JRh(o.reservation.date),t.R7$(6),t.JRh(o.reservation.roomId),t.R7$(5),t.JRh(o.reservation.floor.toUpperCase()),t.R7$(4),t.Y8G("color",o.getStatusColor(o.reservation.status)),t.R7$(),t.SpI(" ",o.getStatusText(o.reservation.status)," "),t.R7$(9),t.SpI("",o.getDisplayAmount()," Fcfa"),t.R7$(5),t.JRh(o.reservation.paymentMethod),t.R7$(5),t.JRh(o.formatDate(o.reservation.timestamp)),t.R7$(5),t.JRh(o.reservation.responsibleName),t.R7$(6),t.Y8G("ngIf",!o.reservation.receiptImage),t.R7$(),t.Y8G("ngIf",o.reservation.receiptImage),t.R7$(),t.Y8G("ngIf","reservee"===o.reservation.status),t.R7$(),t.Y8G("ngIf","payee"===o.reservation.status)}}function O(i,c){if(1&i){const o=t.RV6();t.j41(0,"div",50)(1,"div",51),t.nrm(2,"ion-icon",52),t.k0s(),t.j41(3,"h2"),t.EFF(4,"R\xe9servation confirm\xe9e"),t.k0s(),t.j41(5,"div",53)(6,"p")(7,"strong"),t.EFF(8,"Votre r\xe9servation a \xe9t\xe9 valid\xe9e avec succ\xe8s"),t.k0s()(),t.j41(9,"p"),t.EFF(10,"Votre r\xe9servation a effectivement \xe9t\xe9 prise en compte."),t.k0s(),t.j41(11,"p"),t.EFF(12,"Vous pouvez consulter le contrat de bail dans l'onglet r\xe9servation."),t.k0s(),t.j41(13,"p"),t.EFF(14,"Il faudra le scanner et le renvoyer au propri\xe9taire pour signature des 2 partis."),t.k0s()(),t.j41(15,"ion-button",54),t.bIt("click",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.closeConfirmation())}),t.EFF(16,"OK"),t.k0s()()}}let M=(()=>{var i;class c{constructor(e,n,a,l,d,y){this.route=e,this.router=n,this.actionSheetController=a,this.loadingController=l,this.toastController=d,this.alertController=y,this.showConfirmationModal=!1,(0,_.a)({chevronBackOutline:g.fKZ,informationCircleOutline:g.jdS,cameraOutline:g.GOB,imagesOutline:g.dFz,downloadOutline:g.fPB,checkmarkCircleOutline:g.gz2,closeOutline:g.xfX})}ngOnInit(){const e=Number(this.route.snapshot.paramMap.get("id"));this.loadReservation(e)}loadReservation(e){const n=localStorage.getItem("userReservations");if(n){const a=JSON.parse(n);this.reservation=a.find(l=>l.id===e)}}getDisplayAmount(){return this.reservation?("payee"===this.reservation.status?5e3:this.reservation.amount).toLocaleString():"0"}formatDate(e){return new Date(e).toLocaleDateString("fr-FR")}getStatusColor(e){switch(e){case"reservee":return"warning";case"payee":return"success";default:return"medium"}}getStatusText(e){switch(e){case"reservee":return"R\xe9serv\xe9e";case"payee":return"Pay\xe9e";default:return"Inconnue"}}selectReceiptImage(){var e=this;return(0,p.A)(function*(){yield(yield e.actionSheetController.create({header:"Ajouter une photo du re\xe7u",buttons:[{text:"Prendre une photo",icon:"camera-outline",handler:()=>{e.takePhoto()}},{text:"Choisir dans la galerie",icon:"images-outline",handler:()=>{e.selectFromGallery()}},{text:"Annuler",icon:"close-outline",role:"cancel"}]})).present()})()}takePhoto(){var e=this;return(0,p.A)(function*(){try{const n=yield u.i7.getPhoto({quality:90,allowEditing:!0,resultType:u.LK.DataUrl,source:u.ru.Camera});n.dataUrl&&e.reservation&&(e.reservation.receiptImage=n.dataUrl,e.reservation.receiptFileName=`IMG${Date.now()}-${Math.random().toString(36).substr(2,9)}.jpg`,e.reservation.receiptVerified=!1,e.saveReservation(),yield e.showToast("Photo ajout\xe9e avec succ\xe8s"))}catch(n){console.error("Erreur lors de la prise de photo:",n),yield e.showToast("Erreur lors de la prise de photo","danger")}})()}selectFromGallery(){var e=this;return(0,p.A)(function*(){try{const n=yield u.i7.getPhoto({quality:90,allowEditing:!0,resultType:u.LK.DataUrl,source:u.ru.Photos});n.dataUrl&&e.reservation&&(e.reservation.receiptImage=n.dataUrl,e.reservation.receiptFileName=`IMG${Date.now()}-${Math.random().toString(36).substr(2,9)}.jpg`,e.reservation.receiptVerified=!1,e.saveReservation(),yield e.showToast("Photo ajout\xe9e avec succ\xe8s"))}catch(n){console.error("Erreur lors de la s\xe9lection de photo:",n),yield e.showToast("Erreur lors de la s\xe9lection de photo","danger")}})()}validateReservation(){var e=this;return(0,p.A)(function*(){if(!e.reservation||!e.reservation.receiptImage)return void(yield e.showToast("Veuillez ajouter une photo du re\xe7u","warning"));const n=yield e.loadingController.create({message:"Validation en cours...",duration:2e3});yield n.present(),setTimeout(()=>{e.reservation&&(e.reservation.status="payee",e.reservation.receiptVerified=!0,e.saveReservation()),n.dismiss(),e.showConfirmationModal=!0},2e3)})()}saveReservation(){if(!this.reservation)return;const e=localStorage.getItem("userReservations");if(e){const n=JSON.parse(e),a=n.findIndex(l=>l.id===this.reservation.id);-1!==a&&(n[a]=this.reservation,localStorage.setItem("userReservations",JSON.stringify(n)))}}closeConfirmation(){this.showConfirmationModal=!1}downloadContract(){var e=this;return(0,p.A)(function*(){const n=yield e.loadingController.create({message:"G\xe9n\xe9ration du contrat...",duration:1500});yield n.present(),setTimeout((0,p.A)(function*(){var a;yield n.dismiss(),yield e.showToast("Contrat t\xe9l\xe9charg\xe9 avec succ\xe8s");const d=document.createElement("a");d.href="",d.download="contrat.pdf",document.body.appendChild(d),d.click(),document.body.removeChild(d),console.log("T\xe9l\xe9chargement du contrat pour:",null===(a=e.reservation)||void 0===a?void 0:a.cityName)}),1500)})()}showToast(e){var n=this;return(0,p.A)(function*(a,l="success"){yield(yield n.toastController.create({message:a,duration:2e3,position:"bottom",color:l})).present()}).apply(this,arguments)}}return(i=c).\u0275fac=function(e){return new(e||i)(t.rXU(f.nX),t.rXU(f.Ix),t.rXU(r.GD),t.rXU(r.Xi),t.rXU(r.K_),t.rXU(r.hG))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-reservation-details"]],standalone:!0,features:[t.aNF],decls:11,vars:3,consts:[[1,"ion-no-border"],["slot","start"],["defaultHref","/reservations","color","primary"],[1,"details-content"],["class","payment-alert",4,"ngIf"],["class","reservation-info-section",4,"ngIf"],[3,"didDismiss","isOpen"],[1,"payment-alert"],[1,"alert-icon"],["name","information-circle-outline"],[1,"alert-content"],[1,"reservation-info-section"],[1,"section-header"],[1,"reservation-date"],[1,"info-grid"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"status-badge",3,"color"],[1,"payment-info-section"],[1,"payment-grid"],[1,"payment-item"],[1,"payment-label"],[1,"payment-value","amount"],[1,"payment-value"],[1,"validation-section"],[1,"validation-subtitle"],["class","upload-section",4,"ngIf"],["class","uploaded-receipt",4,"ngIf"],["expand","block","color","primary","class","validate-button",3,"disabled","click",4,"ngIf"],["class","contract-section",4,"ngIf"],[1,"upload-section"],[1,"upload-zone",3,"click"],["name","camera-outline"],[1,"uploaded-receipt"],["alt","Re\xe7u de paiement",3,"src"],[1,"receipt-info"],[1,"receipt-filename"],["href","#",1,"verification-link",3,"click"],["expand","block","color","primary",1,"validate-button",3,"click","disabled"],[1,"contract-section"],[1,"contract-subtitle"],[1,"contract-preview"],[1,"contract-icon"],[1,"contract-info"],[1,"contract-title"],[1,"contract-description"],["color","success","size","small",3,"click"],["name","download-outline","slot","start"],[1,"contract-instructions"],[1,"confirmation-modal"],[1,"confirmation-icon"],["name","checkmark-circle-outline"],[1,"confirmation-content"],["color","primary",3,"click"]],template:function(e,n){1&e&&(t.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t.nrm(3,"ion-back-button",2),t.k0s(),t.j41(4,"ion-title"),t.EFF(5,"D\xe9tails de la r\xe9servation"),t.k0s()()(),t.j41(6,"ion-content",3),t.DNE(7,x,12,0,"div",4)(8,E,55,14,"div",5),t.k0s(),t.j41(9,"ion-modal",6),t.bIt("didDismiss",function(){return n.closeConfirmation()}),t.DNE(10,O,17,0,"ng-template"),t.k0s()),2&e&&(t.R7$(7),t.Y8G("ngIf",n.reservation&&"reservee"===n.reservation.status),t.R7$(),t.Y8G("ngIf",n.reservation),t.R7$(),t.Y8G("isOpen",n.showConfirmationModal))},dependencies:[v.MD,v.bT,r.W9,r.eU,r.ai,r.BC,r.QW,r.el,r.Jm,r.iq,r.In,r.Sb],styles:['@charset "UTF-8";[_nghost-%COMP%]{--primary-color: #1dd1a1;--success-color: #10b981;--warning-color: #f59e0b;--info-color: #3b82f6;--text-primary: #374151;--text-secondary: #6b7280;--background: #ffffff;--border-color: #e5e7eb}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: white;--color: var(--text-primary)}ion-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:var(--text-primary)}.details-content[_ngcontent-%COMP%]{--background: #f8f9fa;--padding-bottom: 20px}.payment-alert[_ngcontent-%COMP%]{background:#dcfce7;border:1px solid #16a34a;border-radius:12px;margin:16px;padding:16px;display:flex;gap:12px}.alert-icon[_ngcontent-%COMP%]{flex-shrink:0;margin-top:2px}.alert-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#16a34a}.alert-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;color:#15803d}.alert-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.reservation-info-section[_ngcontent-%COMP%]{background:#fff;margin:16px;border-radius:12px;padding:20px;box-shadow:0 2px 8px #0000001a}.section-header[_ngcontent-%COMP%]{margin-bottom:24px;text-align:center}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;font-weight:600;color:var(--text-primary)}.reservation-date[_ngcontent-%COMP%]{margin:0;font-size:14px;color:var(--text-secondary)}.info-grid[_ngcontent-%COMP%]{display:grid;gap:16px;margin-bottom:32px}.info-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid #f0f0f0}.info-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.info-label[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary);font-weight:500}.info-value[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--text-primary)}.status-badge[_ngcontent-%COMP%]{font-size:12px;font-weight:600;padding:6px 12px;border-radius:16px}.payment-info-section[_ngcontent-%COMP%]{margin-bottom:32px}.payment-info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:var(--text-primary)}.payment-grid[_ngcontent-%COMP%]{display:grid;gap:12px}.payment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0}.payment-label[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary)}.payment-value[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:var(--text-primary)}.payment-value.amount[_ngcontent-%COMP%]{color:var(--success-color);font-weight:600}.validation-section[_ngcontent-%COMP%]{margin-bottom:32px}.validation-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:var(--text-primary)}.validation-subtitle[_ngcontent-%COMP%]{margin:0 0 16px;font-size:14px;color:var(--text-secondary)}.upload-zone[_ngcontent-%COMP%]{border:2px dashed var(--border-color);border-radius:12px;padding:40px 20px;text-align:center;cursor:pointer;transition:all .3s ease;margin-bottom:16px}.upload-zone[_ngcontent-%COMP%]:hover{border-color:var(--primary-color);background:#f0fdf4}.upload-zone[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:32px;color:var(--text-secondary);margin-bottom:8px}.upload-zone[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;font-size:14px;color:var(--text-secondary);font-weight:500}.uploaded-receipt[_ngcontent-%COMP%]{border:1px solid var(--border-color);border-radius:12px;padding:16px;margin-bottom:16px}.uploaded-receipt[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:200px;object-fit:cover;border-radius:8px;margin-bottom:12px}.receipt-info[_ngcontent-%COMP%]{text-align:center}.receipt-filename[_ngcontent-%COMP%]{margin:0 0 8px;font-size:12px;color:var(--text-secondary);font-family:monospace}.verification-link[_ngcontent-%COMP%]{font-size:14px;color:var(--info-color);text-decoration:none;font-weight:500}.verification-link.verified[_ngcontent-%COMP%]{color:var(--success-color)}.validate-button[_ngcontent-%COMP%]{--border-radius: 12px;--padding-top: 16px;--padding-bottom: 16px;height:56px;font-weight:600}.validate-button[_ngcontent-%COMP%]:disabled{--background: #d1d5db;--color: #9ca3af}.contract-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:16px;font-weight:600;color:var(--text-primary)}.contract-subtitle[_ngcontent-%COMP%]{margin:0 0 16px;font-size:14px;color:var(--text-secondary)}.contract-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#f8f9fa;border-radius:12px;margin-bottom:16px}.contract-icon[_ngcontent-%COMP%]{font-size:32px;flex-shrink:0}.contract-info[_ngcontent-%COMP%]{flex:1}.contract-title[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;font-weight:600;color:var(--text-primary)}.contract-description[_ngcontent-%COMP%]{margin:0;font-size:12px;color:var(--text-secondary)}.contract-instructions[_ngcontent-%COMP%]{padding:12px;background:#fffbeb;border-radius:8px;border:1px solid #fbbf24}.contract-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:#92400e;line-height:1.4}.confirmation-modal[_ngcontent-%COMP%]{padding:40px 24px;text-align:center}.confirmation-icon[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:#1f2937;display:flex;align-items:center;justify-content:center;margin:0 auto 24px}.confirmation-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px;color:var(--success-color)}.confirmation-modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:20px;font-weight:600;color:var(--text-primary)}.confirmation-content[_ngcontent-%COMP%]{margin-bottom:24px}.confirmation-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;color:var(--text-secondary);line-height:1.5}.confirmation-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.confirmation-modal[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;--padding-top: 12px;--padding-bottom: 12px;font-weight:600;min-width:120px}@media (max-width: 768px){.reservation-info-section[_ngcontent-%COMP%]{margin:12px;padding:16px}.payment-alert[_ngcontent-%COMP%]{margin:12px;padding:12px}.contract-preview[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.confirmation-modal[_ngcontent-%COMP%]{padding:24px 20px}}']}),c})()}}]);